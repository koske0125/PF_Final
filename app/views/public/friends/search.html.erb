<div class="container-fluid">
  <div class="col-12 col-md-8 col-lg-6 col-xl-10 mx-auto mt-3">
    <h2 class="mt-3">検索フォーム</h2>
    <%= search_form_for @q, url: search_public_friends_path do |f| %>
    <table class="table">
      <tr>
        <th class="text-center">ランク</th>
        <td><%= f.select :rank_eq, Friend.ranks.keys.map {|k| [I18n.t("enums.friend.ranks.#{k}"), k]}, {include_blank: '指定なし'}, class: "form-select" %></td>
      </tr>
      <tr>
        <th class="text-center">募集目的</th>
        <td>
          <%= f.check_box :is_rank_eq,{include_hidden: false}, class: "form-check-input" %>
          <%= f.label "ランク", class: "form-check-label me-2" %>
          <%= f.check_box :is_normal_eq,{include_hidden: false}, class: "form-check-input" %>
          <%= f.label "ノーマル", class: "form-check-label me-2" %>
          <%= f.check_box :is_beginner_eq,{include_hidden: false}, class: "form-check-input" %>
          <%= f.label "初心者同士で遊びたい", class: "form-check-label me-2" %>
          <%= f.check_box :is_coaching_eq,{include_hidden: false}, class: "form-check-input" %>
          <%= f.label "コーチングをしたい", class: "form-check-label me-2" %>
          <%= f.check_box :is_coached_eq,{include_hidden: false}, class: "form-check-input" %>
          <%= f.label "コーチングを受けたい", class: "form-check-label me-2" %>
          <%= f.check_box :is_clash_eq,{include_hidden: false}, class: "form-check-input" %>
          <%= f.label "Clashのメンバーを見つけたい", class: "form-check-label" %>
        </td>
      </tr>
      <tr>
        <th class="text-center">得意なレーン</th>
        <td>
          <%= f.check_box :good_at_top, class: "form-check-input" %>
          <%= f.label "トップ", class: "form-check-label me-2" %>
          <%= f.check_box :good_at_jg, class: "form-check-input" %>
          <%= f.label "ジャングル", class: "form-check-label me-2" %>
          <%= f.check_box :good_at_mid, class: "form-check-input" %>
          <%= f.label "ミッド", class: "form-check-label me-2" %>
          <%= f.check_box :good_at_adc, class: "form-check-input" %>
          <%= f.label "ボットレーン(ADC)", class: "form-check-label me-2" %>
          <%= f.check_box :good_at_sup, class: "form-check-input" %>
          <%= f.label "サポート", class: "form-check-label" %>
        </td>
      </tr>
      <tr>
        <th class="text-center">苦手なレーン</th>
        <td>
          <%= f.check_box :bad_at_top, class: "form-check-input" %>
          <%= f.label "トップ", class: "form-check-label me-2" %>
          <%= f.check_box :bad_at_jg, class: "form-check-input" %>
          <%= f.label "ジャングル", class: "form-check-label me-2" %>
          <%= f.check_box :bad_at_mid, class: "form-check-input" %>
          <%= f.label "ミッド", class: "form-check-label me-2" %>
          <%= f.check_box :bad_at_adc, class: "form-check-input" %>
          <%= f.label "ボットレーン(ADC)", class: "form-check-label me-2" %>
          <%= f.check_box :bad_at_sup, class: "form-check-input" %>
          <%= f.label "サポート", class: "form-check-label" %>
        </td>
      </tr>
      <tr>
        <th class="text-center">ボイスチャット</th>
        <td>
          <%= f.radio_button :vc_status, "unavailable", class: "form-check-input" %>
          <%= f.label "ボイスチャット不可", class: "form-check-label me-2" %>
          <%= f.radio_button :vc_status, "listening_only", class: "form-check-input" %>
          <%= f.label "聴き専", class: "form-check-label me-2" %>
          <%= f.radio_button :vc_status, "available", class: "form-check-input" %>
          <%= f.label "ボイスチャット可能", class: "form-check-label me-2" %>
        </td>
      </tr>
      <tr>
        <th class="text-center">利用可能なボイスチャット</th>
        <td>
          <%= f.check_box :vc_discord, class: "form-check-input" %>
          <%= f.label "Discord", class: "form-check-label me-2" %>
          <%= f.check_box :vc_skype, class: "form-check-input" %>
          <%= f.label "Skype", class: "form-check-label me-2" %>
          <%= f.check_box :vc_leaguevoice, class: "form-check-input" %>
          <%= f.label "リーグボイス", class: "form-check-label" %>
        </td>
      </tr>
    </table>
    <div class="text-center"><%= f.submit "検索", class: "btn btn-success" %></div>
    <% end %>

    <h2 class="mt-3">投稿一覧</h2>
    <div class="row row-cols-1 row-cols-md-1 row-cols-lg-1 row-cols-xl-2 g-4">

      <% @friends.each do |friend| %>
      <div class="col">
        <div class="card border-dark h-100">
          <div class="card-body">
            <h5 class="card-title">
              <% if friend.user.profile_image.attached? %>
                <%= image_tag friend.user.profile_image, size: "32x32", class: "rounded-circle me-2" %>
              <% else %>
                <%= image_tag asset_path("no_image.jpg"), size: "32x32", class: "rounded-circle me-2" %>
              <% end %>
              <%= friend.user.name %></h5>
            <p class="card-text ms-3"><%= friend.introduction.truncate(130) %></p>
            <table class="table text-center">
              <tr>
                <th>ランク</th>
                <td><%= friend.rank_i18n %></td>
              </tr>
              <tr>
                <th>好きなチャンピオン</th>
                <td><%= friend.favorite_champion %></td>
              </tr>
              <tr>
                <th>募集目的</th>
                <td>
                  <% if friend.is_rank == true %> &#10003;ランク　<% end %>
                  <% if friend.is_normal == true %> &#10003;ノーマル　<% end %>
                  <% if friend.is_beginner == true %> &#10003;初心者同士で遊びたい　<% end %>
                  <% if friend.is_coaching == true %> &#10003;コーチングをしたい　<% end %>
                  <% if friend.is_coached == true %> &#10003;コーチングを受けたい　<% end %>
                  <% if friend.is_clash == true %> &#10003;Clashのメンバーを見つけたい<% end %>
                </td>
              </tr>
              <tr>
                <th>得意なレーン</th>
                <td>
                  <% if friend.good_at_top == true %> &#10003;トップレーン　<% end %>
                  <% if friend.good_at_jg == true %> &#10003;ジャングル　<% end %>
                  <% if friend.good_at_mid == true %> &#10003;ミッドレーン　<% end %>
                  <% if friend.good_at_adc == true %> &#10003;ボットレーン(ADC)　<% end %>
                  <% if friend.good_at_sup == true %> &#10003;サポート<% end %>
                </td>
              </tr>
              <tr>
                <th>苦手なレーン</th>
                <td>
                  <% if friend.bad_at_top == true %> &#10003;トップレーン　<% end %>
                  <% if friend.bad_at_jg == true %> &#10003;ジャングル　<% end %>
                  <% if friend.bad_at_mid == true %> &#10003;ミッドレーン　<% end %>
                  <% if friend.bad_at_adc == true %> &#10003;ボットレーン(ADC)　<% end %>
                  <% if friend.bad_at_sup == true %> &#10003;サポート<% end %>
                </td>
              </tr>
              <tr>
                <th>活動時間帯</th>
                <td><%= friend.active_time %></td>
              </tr>
              <tr>
                <th>Twitter</th>
                <td><% if friend.twitter != " " %><a href="https://twitter.com/<%= friend.twitter %>", target="_blank">@<%= friend.twitter %></a><% else %><% end %></td>
              </tr>
              <tr>
                <th>ボイスチャット</th>
                <td><%= friend.vc_status_i18n %></td>
              </tr>
              <tr>
                <th>利用可能なボイスチャット</th>
                <td>
                  <% if friend.vc_discord == true %> &#10003;Discord　<% end %>
                  <% if friend.vc_skype == true %> &#10003;Skype　<% end %>
                  <% if friend.vc_leaguevoice == true %> &#10003;リーグボイス<% end %>
                </td>
              </tr>
            </table>
            <p class="card-text text-center">
            <% if user_signed_in? %>
              <%= link_to "フォローする", "#", class: "btn btn-primary me-3" %>
              <%= link_to "ダイレクトメッセージを送る", "#", class: "btn btn-success me-3" %>
            <% end %>
            <%= link_to "詳細を見る", public_friend_path(friend), class: "btn btn-info text-white" %>
            </p>
          </div>
          <div class="card-footer">
            <small class="text-muted">最終更新日:<%= friend.updated_at.strftime("%Y年%m月%d日") %></small>
          </div>
        </div>
      </div>
      <% end %>
    </div>
  </div>
</div>